<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank Customer Segmentation</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>

<body>
    <main class="container size">
        <div class="d-flex align-items-center p-3 my-3 rounded shadow-sm titlestyle">
            <div class="lh-1">
                <header class="bd-header py-3 d-flex align-items-center justify-content-center border-bottom">
                    <h1 class="h2 mb-0 text-dark lh-1 text-center">Bank Customer Segmentation</h1>
                </header>
            </div>
        </div>

        <div class="my-3 p-3 bg-body rounded shadow-sm" style="background-color: #f5f5f5 !important;">
            <div class="container">
                <form class="formstyle" action="{{ url_for('model') }}" method="post">
                    <div class="row">
                        <div class="col-lg-6">
                            <!-- Input fields for customer data -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Age</span>
                                <input type="text" name="Age" class="form-control" required>
                            </div>
                            <!-- Input fields for Annual Income -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Annual Income</span>
                                <span class="input-group-text">₹</span>
                                <input type="text" name="Annual Income" class="form-control" required>
                            </div>
                            <!-- Input fields for Account Balance -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Account Balance</span>
                                <span class="input-group-text">₹</span>
                                <input type="text" name="AccountBalance" class="form-control" required>
                            </div>
                            <!-- Input fields for Credit Score -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Credit Score</span>
                                <input type="text" name="credit_score" class="form-control" required>
                            </div>
                            <!-- Input fields for Occupation -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Occupation</span>
                                <select name="Occupation" class="form-select" required>
                                    <option value="Salaried">Salaried</option>
                                    <option value="Business">Business</option>
                                    <option value="Housewife">Housewife</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <!-- Input fields for Net Worth -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Net Worth</span>
                                <span class="input-group-text">₹</span>

                                <input type="text" name="Networth" class="form-control" required>
                            </div>
                            <!-- Input fields for House -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">House</span>
                                <select name="House" class="form-select" required>
                                    <option value="owned">owned</option>
                                    <option value="rented">rented</option>
                                </select>
                            </div>
                            <!-- Input fields for Vehicle -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Vehicle</span>
                                <select name="Vehicle" class="form-select" required>
                                    <option value="yes">yes</option>
                                    <option value="no">no</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <!-- Input fields for Active Loans -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Active Loans</span>
                                <input type="text" name="Active_loans" class="form-control" required>
                            </div>
                            <!-- Input fields for Bank Products -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Bank Products</span>
                                <input type="text" name="Bank_Products" class="form-control" required>
                            </div>
                            <!-- Input fields for Fixed Deposit -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Fixed Deposit</span>
                                <select name="Fixed Deposit" class="form-select" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <!-- Input fields for Tenure -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Tenure</span>
                                <input type="text" name="Tenure" class="form-control" required>
                            </div>
                            <!-- Input fields for Last Month Transactions -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Last Month Transactions</span>
                                <input type="text" name="LastMonthTrans" class="form-control" required>
                            </div>
                            <!-- Input fields for Gender -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Gender</span>
                                <select name="Gender" class="form-select" required>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                            </div>
                            <!-- Input fields for Education -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Education</span>
                                <select name="Education" class="form-select" required>
                                    <option value="Under Graduate">Under Graduate</option>
                                    <option value="Graduate">Graduate</option>
                                    <option value="Post Graduate">Post Graduate</option>
                                </select>
                            </div>
                            <!-- Input fields for Marital Status -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Marital Status</span>
                                <select name="Married" class="form-select" required>
                                    <option value="yes">Yes</option>
                                    <option value="no">No</option>
                                </select>
                            </div>
                            <!-- Input fields for Dependents -->
                            <div class="input-group mb-3">
                                <span class="input-group-text variable">Dependents</span>
                                <input type="text" name="Dependents" class="form-control" required>
                            </div>
                        </div>
                    </div>

                    <div class="wrapper">
                        <button type="submit" class="btn btn-primary"
                            style="font-size: 20px; background-color: rgb(65, 65, 241); font-weight: bold;">Predict</button>
                        <a href="{{ url_for('images') }}" target="_blank" class="btn btn-secondary"
        style="font-size: 20px; background-color: rgb(34, 34, 34); font-weight: bold;">View Cluster Properties</a>

                    </div>
                </form>
            </div>

            {% if prediction %}
            <div class="my-3 p-3 bg-body rounded shadow-sm">
                <h4 class="border-bottom pb-2 mb-0" style="font-size: 30px;">Prediction</h4>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="pb-3 mb-0 small lh-sm border-bottom w-100">
                            <strong class="text-gray-dark" style="font-size: 23px; padding: 10px;">Cluster</strong>
                            <br><span class="d-block" style="font-size: 17px;">{{ prediction }}</span><br>
                            <p style="font-size: 17px; text-align: justify; margin-bottom: 35px;">
                                <b class="Insight" style="font-size: 17px;">Business Insight: </b><span class="insight-text">{{ insight }}</span>
                            </p>
                            <p style="font-size: 17px; text-align: justify; margin-top: 0;">
                                <b class="Recommendation" style="font-size: 17px;">Business Recommendation: </b><span class="recommendation-text">{{ recommendation }}</span>
                            </p>
                        </div>
                    </div>

                </div>

                <form method="post" action="/generate_email">
                    <input type="hidden" name="cluster" value="{{ cluster }}">
                    <button type="submit" class="btn btn-secondary"
                        style="font-size: 20px; background-color: rgb(34, 34, 34); font-weight: bold;">Generate Email
                        Content</button>
                </form>
            </div>
            {% endif %}
            {% if email_content %}
            <div class="my-3 p-3 bg-body rounded shadow-sm">
                <h4 class="border-bottom pb-2 mb-0" style="font-size: 30px;">Email Content</h4>
                <p><strong>Subject:</strong> {{ subject }}</p>
                <p>{{ email_content }}</p>

                <form method="post" action="/send_email">
                    <input type="hidden" name="subject" value="{{ subject }}">
                    <input type="hidden" name="email_content" value="{{ email_content }}">

                    <!-- Input for recipient email -->
                    <div class="mb-3">
                        <label for="recipient_email" class="form-label">Recipient Email:</label>
                        <input type="email" id="recipient_email" name="recipient_email" class="form-control" required>
                    </div>

                    <button type="submit" class="btn btn-success"
                        style="font-size: 20px; background-color: rgb(28, 184, 65); font-weight: bold;">Send Email</button>
                </form>

            </div>
            {% endif %}
